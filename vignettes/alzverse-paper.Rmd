---
title: "Alzheimer's Clinical Research Data via R Packages: the alzverse"
author:
  - name: Michael C. Donohue
    affiliation: ATRI
    correspondingauthor: true
  - name: Kedir Hussen
    affiliation: ATRI
  - name: Oliver Langford
    affiliation: ATRI
  - name: Richard Gallardo
    affiliation: ATRI
  - name: Gustavo Jimenez-Maggiora
    affiliation: ATRI
  - name: Paul S. Aisen
    affiliation: ATRI
  - name: "for the Alzheimer's Disease Neuroimaging Initiative"
    footnote: 1
address:
  - code: ATRI
    organization: Alzheimer's Therapeutic Research Institute, University of Southern California
    city: San Diego
    state: CA
    postcode: 92121
    country: United States
footnote:
  - code: 1
    text: "Data used in preparation of this article were obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database (\\url{adni.loni.usc.edu}). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in the analysis or writing of this report. A complete listing of ADNI investigators can be found at: \\url{http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf}."
abstract: |
  Sharing clinical research data is essential for advancing research in Alzheimer's disease (AD) and other therapeutic areas. However, challenges in data accessibility, standardization, documentation, usability, and reproducibility continue to impede this goal. In this article, we highlight the advantages of using R packages to overcome these challenges using two examples. The `A4LEARN` R package includes data from a randomized trial (the Anti-Amyloid Treatment in Asymptomatic Alzheimer’s [A4] study) and its companion observational study of biomarker negative individuals (the Longitudinal Evaluation of Amyloid Risk and Neurodegeneration [LEARN] study). The `ADNIMERGE2` R package includes data from the Alzheimer’s Disease Neuroimaging Initiative (ADNI), a longitudinal observational biomarker and imaging study. These packages collect data, documentation, and reproducible analysis vignettes into a portable bundle that can be installed and browsed within commonly used R programming environments. We also introduce the `alzverse` package which leverages a common data standard to combine study-specific data packages to facilitate meta-analyses. By promoting collaboration, transparency, and reproducibility, R data packages can play a vital role in accelerating clinical research.
keywords: 
  - open data
  - clinical trial
  - R
  - Alzheimer's
journal: "Arxiv"
date: "2025-09-17"
linenumbers: false
numbersections: false
bibliography: references.bib
biblio-style: elsarticle-harv # author year style for natbib - use 'elsarticle-num' or 'elsarticle-num-names' for numbered scheme
classoption: preprint, 3p, authoryear # remove authoryear is not using `elsarticle-harv`
# Use a CSL with `citation_package = "default"`
# csl: https://www.zotero.org/styles/elsevier-harvard
output: 
  rticles::elsevier_article:
    keep_tex: true
    citation_package: natbib
---

```{r, include = FALSE}
library(alzverse)
library(tidyverse)
library(gtsummary)
library(labelled)
library(gt)

knitr::opts_chunk$set(collapse = TRUE, comment = "#>", 
  dev = 'png', dpi = 300, fig.width = 6, fig.height = 6/1.6,
  out.width = "100%", fig.path = './')

options(width = 68, cli.unicode = FALSE, cli.width = 68)
theme_set(theme_bw() + 
    theme(legend.background = element_rect(fill='transparent')))
# to output tex:
# rmarkdown::render('./alzverse-paper.Rmd', clean = FALSE)
```

## Introduction

Alzheimer's disease (AD) is among the most important neurodegenerative diseases worldwide. The Alzheimer’s Disease Neuroimaging Initiative (ADNI) [@weiner2025overview] and similar projects have accumulated vast quantities of clinical, neuroimaging, and biomarker data, creating opportunities for scientific advances in the understanding and treatment of AD. ADNI data have supported more than 6000 scientific papers publications [@weiner2025overview].

Availability of such data is on the rise, due in part to data sharing mandates from funders like the National Institutes of Health. However, it often takes considerable time and effort for researchers to gain sufficient familiarity with the data to produce meaningful analyses. Learning curves can be steep due to inadequate or hard-to-locate documentation and example analysis code.

Open-source software solutions, particularly in the form of R packages [@R-base; @wickham2023r], offer significant potential to address these barriers. The R programming language is widely used in biostatistics, machine learning, and clinical research. R packages are a well-known means for distributing cutting edge statistical software and documentation, and they often include data and analysis vignettes which demonstrate how the methods can be applied. Importantly, R packages can also be an effective tool to share data itself. For example, the authors have maintained the `ADNIMERGE` R data package since 2017 [@ADNI2023]. It has been cited by about 250 articles^[Based on a Google Scholar search of "ADNIMERGE" AND "package"] and has inspired related projects, such as the ANMERGE package of AddNeuroMed Consortium data [@birkenbihl2021anmerge]. Similarly, @vuorre2021sharing demonstrated the utility of R packages for sharing data and analysis code from psychological experiments. 

We discuss how R packages can also facilitate easy access, harmonization, and analysis of larger clinical datasets from AD studies. These packages are built with the goal of providing an audit trail of derived data provenance, supporting reproducible research, and leveraging outstanding R tools for unit testing and validation [@testthat], websites [@pkgdown], and regulatory submissions [@pharmaverse2023]. 

In this paper we discuss the advantages of using R packages to share large clinical study datasets, and provide two new examples: the `A4LEARN` packages which includes data from a randomized trial (the Anti-Amyloid Treatment in Asymptomatic Alzheimer’s [A4] study) [@sperling2023trial] and its companion observational study of biomarker negative individuals (the Longitudinal Evaluation of Amyloid Risk and Neurodegeneration [LEARN] study) [@sperling2024amyloid]; and the `ADNIMERGE2` package, which includes latest data from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) [@weiner2025overview]. We also introduce the [`alzverse`](https://atri-biostats.github.io/alzverse/) meta data package, which demonstrates how `ADNIMERGE2`, `A4LEARN`, and other R data packages can be combined to facilitate meta-analyses.

## Advantages of R Data Packages

### Reproducibility, Portability and Documentation

The most important advantage of using R data packages for sharing clinical research data is that it facilitates reproducible research. R is widely available and free to download [@R], commonly used in statistics courses, and has active development communities including academic statisticians, pharmaceutical statisticians, and commercial enterprises such as Posit's RStudio Integrated Development Environment (IDE).

All R packages include a manual that details the functions and datasets in a standardized format. This content is linked to the R object's name, is readily accessible to the R user (e.g. by typing `?t.test`, or `?cars`) and can be browsed within the IDE. This is a substantial improvement over the typical case in which relevant data documentation might be scattered across unlinked documents or data dictionary spreadsheets. R packages also typically provide analysis "vignettes", which demonstrate how functions can be applied to available datasets to produce analysis results as tables or figures. These are also linked and can be browsed within the IDE. Our `A4LEARN` package contains a vignette to exactly reproduce key findings of the published manuscript reporting the trial results [@sperling2023trial]. This code can be used by outside researchers to jump start their own inquiries and help ensure the data is being used correctly and efficiently in a manner consistent with the intentions of the study team.  

The R package bundle of data, R functions, documentation and vignettes is made portable as an efficiently compressed file which can be installed on any machine running R. Data files within the package are also efficiently compressed using R's `.RData` file format. These `.RData` files can be read by SPSS, Stata, and SAS, allowing researchers to access and analyze the data using a variety of statistical software beyond R. Another advantage of `.RData` compared to tabular text files (e.g. `.csv` files), is that they can utilize R object classes such as dates and factor variables, eliminating the need to process and annotate data prior to analysis.

The `pkgdown` R package [@pkgdown] makes it trivial to export documentation and vignettes as a website, and integrates well with code repositories such as GitHub. These `pkgdown` websites are searchable and provide access to documentation and examples for researchers, even if they do not use R. See [atri-biostats.github.io/A4LEARN/](https://atri-biostats.github.io/A4LEARN) and [atri-biostats.github.io/ADNIMERGE2](https://atri-biostats.github.io/ADNIMERGE2) for examples.

### Standardized and Efficient Workflow and Testing

Questions often arise about the original source of data or how derived variables were determined. Therefore, it is crucial to preserve a record of data provenance. This is important whenever reproducible research is a goal, and particularly for submissions to regulators, such as the FDA. The standardized R package structure and build workflow makes the data provenance transparent. R packages also have a standardized framework for testing [@testthat] and tools for “assertive” programming to verify assumptions about the data [@assertr]. 

The R package structure and workflow have been well-documented [@wickham2023r]. Here we briefly review the structure while highlighting some key aspects in the context of the clinical research data.

**data-raw**. The `data-raw` directory is intended to contain raw data and code to import and process raw data and store `.Rdata` files in the `data` directory. Raw data can be preserved in the package with minimal manipulation, or it can be processed attaching meta data (variable labels and units), and ensuring factors and dates are stored as the correct object class. Data dictionary spreadsheets can be parsed to provide content for manual pages [@roxygen2].

**vignettes**. The `vignettes` directory contains analysis demonstrations, typically as Rmarkdown (`.Rmd`) files [@rmarkdown]. We prefer to create derived datasets and variables in the form of a vignette as well, so that derivations are easily accessible to researchers within the IDE. These vignettes can include assertive programming to ensure data conforms to expectations [@assertr]. `ADNIMERGE2` contains vignettes which use [`pharmaverse`](https://pharmaverse.org/) workflows to derive Clinical Data Interchange Standards Consortium (CDISC) Analysis Data Model (ADaM) datasets.

**R**. The R directory contains `.R` files with code defining R functions and their manual content [@roxygen2]. This directory can store scoring functions, which might be necessary to derive scores from item-level data from psychometric assessments, for example.

**testthat**. The `testthat` directory includes automated tests that are checked when the package is built. Critically important code that merits replication by independent programmers can be tested here to ensure equivalent results with real or test data.

**reports**. Report code that is not desired as a vignette can be stored in a separate directory for general reports. Of note, `rmarkdown` supports "parameterized reports", which can produce different output depending on the supplied parameter(s). Clinical trials like A4 often include several outcomes collected on the same schedule and analyzed with the same approach. Instead of writing identical code for several outcomes, one generic parameterized rmarkdown file can produce all these reports. Clinical trial outcomes are often aggregated into one long dataset with a row for each subject, time point, and outcome (see `ADQS` in the `A4LEARN` package). The parameterized report can filter this long dataset for the desired outcome and analyze only that outcome. Furthermore, using R parallel programming tools (e.g. @multidplyr), these reports can be produced in parallel. In the case of the A4 trial read out, once data from the blinded phase was locked and unblinded it only took about 30 minutes to build the final data package and render all planned analysis reports and summary slide decks. Prior to data lock, code and output were tested and reviewed using pseudo arm codes.

## Example R Data Packages

The primary data sources for the packages are derived from the Alzheimer's Disease Neuroimaging Initiative (ADNI) and the A4 and LEARN companion studies [@jimenez2024maximizing]. These datasets include longitudinal clinical and neuroimaging data, cognitive test scores, genetic and biomarker data, and other modalities that have been harmonized to facilitate cross-study comparisons.

To ensure usability and consistency, we curated the datasets by mapping variables to standardized terminologies (e.g., CDISC ADaM), handling missing data through imputation techniques, and deriving key analysis variables.

`A4LEARN` and `ADNIMERGE2` were developed using best practices in R package development, including:

* R Package Architecture: Each package is modular, supporting various stages of data analysis, from raw data processing to the generation of regulatory-compliant datasets.
* Data Standardization: The packages support standardization of clinical data, with built-in functions to harmonize variable formats, handle missing values, and generate standardized metadata.
* Reproducibility: Built-in vignettes and examples guide users through the installation, data loading, and analysis processes. The packages integrate with tools like `renv` and Docker to facilitate reproducibility in different computing environments.

The R package framework facilitates the creation of ADaM datasets, which are the gold standard for statistical analysis in clinical trials. The `admiral` package [@admiral] is used to generate ADaM datasets for `ADNIMERGE2`. Other `pharmaverse` tools can be used to create regulatory-compliant tables, listings, and figures. R code to produce the example summaries below is included in the Code Availability section.


The `ADNIMERGE2` package was built using `pharmaverse` tools. It can be downloaded from [loni.usc.edu](loni.usc.edu). Below are examples of some basic summaries of participant characteristics by phase, or wave, of ADNI can be created using the `ADSL` table  (Table 1) and a spaghetti plot of ADAS-Cog scores using the `ADQS` table (Figure 1). Similarly, `A4LEARN` package data can be easily summarized using its `SUBJINFO` table (Table 2). Finally, data from all three studies can be easily summarized using the meta `ADQS` table of the `alzverse` package (Figure 2).

```{r adni-overall-summary, echo = FALSE, out.height = "9in", out.width= "5in", message = FALSE}
tab1 <- tbl_summary(
  data = ADNIMERGE2::ADSL %>% filter(ENRLFL %in% "Y"),
  by = ORIGPROT,
  include = c(AGE, SEX, EDUC, RACE, ETHNIC, DX, APOE, ADASTT13, CDRSB, MMSCORE),
  type = all_continuous() ~ "continuous2",
  statistic = list(
    all_continuous() ~ "{mean} ({sd})",
    all_categorical() ~ "{n} ({p}%)"
  ),
  digits = all_continuous() ~ 1,
  percent = "column",
  missing_text = "(Missing)"
) %>%
  add_overall(last = TRUE) %>%
  add_stat_label(label = all_continuous2() ~ "Mean (SD)") %>%
  modify_footnote_header(
    footnote = "Column-wise percentage; n (%)",
    columns = all_stat_cols(),
    replace = TRUE
  ) %>%
  modify_abbreviation(abbreviation = 
  "ADNI: Alzheimer’s Disease Neuroimaging Initiative; 
    CN: Cognitive Normal; MCI: Mild Cognitive Impairment; 
    DEM: Dementia; 
    ADAS-Cog: Alzheimer's Disease Assessment Scale--Cognitive subscale; 
    CDR: Clinical Dementia Rating; 
    MMSE: Mini Mental State Exam.") %>%
  modify_caption(
    caption = "Table 1. ADNI - Subject Characteristics by Study Phase") %>%
  bold_labels() %>%
  as_gt()

gtsave(tab1, filename = "Table-1-ADNI.png")
knitr::include_graphics("Table-1-ADNI.png")
```

```{r adni-adas-indiv-profile-plot, warning = FALSE, fig.alt = "Individual profile plot", fig.cap = "Figure 1. Spaghetti plot of ADAS-cog13 scores in ADNI by baseline clinical diagnosis.", echo = FALSE}
# Individual profile (spaghetti) plot
ADNIMERGE2::ADQS %>%
  # Enrolled participant
  filter(ENRLFL %in% "Y") %>%
  # ADAS-cog item-13 total score
  filter(PARAMCD %in% "ADASTT13") %>%
  mutate(Years = convert_number_days(ADY, unit = 'year')) %>%
  filter(!if_any(all_of(c("Years", "DX", "AVAL")), ~ is.na(.x))) %>%
ggplot(aes(x = Years, y = AVAL, group = USUBJID, color = DX)) +
  geom_line(alpha = 0.25) +
  scale_color_manual(values = c("#73C186", "#F2B974", "#DF957C", "#999999")) +
  labs(
    y = "ADAS-cog13 Total Score",
    x = "Years since baseline visit",
    color = "Baseline Diagnostics Status") +
  theme(legend.position = "bottom") +
  guides(colour = guide_legend(override.aes = list(alpha = 1)))
```

```{r a4learn-overall-summary, echo = FALSE, message = FALSE, out.width = "4.5in", out.height = "5.22in"}
tab2 <- tbl_summary(
  data = A4LEARN::SUBJINFO %>% filter(SUBSTUDY %in% c('A4', 'LEARN')),
  by = SUBSTUDY,
  include = c(AGEYR, SEX, EDCCNTU, RACE, ETHNIC, APOEGN, AMYLCENT),
  label = list(AGEYR = "Age, years", SEX = 'Sex', EDCCNTU = 'Education, years', 
    RACE = 'Race', ETHNIC = 'Ethnicity', APOEGN = 'APOE genotype',
    AMYLCENT = 'Amyloid PET, Centiloids'),
  type = all_continuous() ~ "continuous2",
  statistic = list(
    all_continuous() ~ "{mean} ({sd})",
    all_categorical() ~ "{n} ({p}%)"
  ),
  digits = all_continuous() ~ 1,
  percent = "column",
  missing_text = "(Missing)"
) %>%
  add_overall(last = TRUE) %>%
  add_stat_label(label = all_continuous2() ~ "Mean (SD)") %>%
  modify_footnote_header(
    footnote = "Column-wise percentage; n (%)",
    columns = all_stat_cols(),
    replace = TRUE
  ) %>%
  modify_abbreviation(abbreviation = 
    "A4: Anti-Amyloid Treatment in Asymptomatic Alzheimer’s study; 
    LEARN: Longitudinal Evaluation of Amyloid Risk and Neurodegeneration.") %>%
  modify_caption(
    caption = "Table 2. A4 and LEARN - Subject characteristics by study.") %>%
  bold_labels() %>%
  as_gt()

gtsave(tab2, filename = "Table-2-A4LEARN.png")
knitr::include_graphics("Table-2-A4LEARN.png")
```

```{r adni-a4-learn-indiv-profile-plot, warning = FALSE, fig.alt = "Individual profile plot", fig.cap = "Figure 2. Spaghetti plot of MMSE scores in ADNI CN, A4, and LEARN.", echo = FALSE}
alzverse::ADQS %>%
  filter(DX == 'CN' | STUDYID %in% c('A4', 'LEARN'), 
    PARAMCD == 'MMSE') %>%
  mutate(Years = convert_number_days(ADY, unit = 'year')) %>%
ggplot(aes(x = Years, y = AVAL, color = STUDYID)) +
  geom_line(aes(group = USUBJID), alpha = 0.25) +
  labs(
    y = "MMSE Total Score",
    x = "Years since baseline visit",
    color = "Study") +
  theme(legend.position = "bottom") +
  guides(colour = guide_legend(override.aes = list(alpha = 1)))
```

## Discussion

The development of `A4LEARN` and `ADNIMERGE2` represents a step forward in enabling the Alzheimer's disease research community to share and analyze data more effectively, serving as a template for additional future study packages. These packages facilitate the transition from proprietary software like SAS to open-source tools, allowing greater flexibility and transparency in the research process. The shift from SAS to R reflects a broader trend in the clinical research community toward open-source and reproducible research practices, as exemplified by the `pharmaverse` project.

Challenges remain, particularly in the area of data access. In our examples data packages can be sourced using the existing data access models. This puts the onus on data users to go to different sites to obtain data. Once retrieved, the use of locally installed packages poses potential risks, which can be mitigated by using containerization and package management tools like Docker and `renv` [@renv] for version control. A streamlined future improvement on this model might entail the use access keys and Application Programming Interfaces (APIs) to source data directly within R.

We envision the `alzverse` project expanding to include many more studies. Our plan is to continue building R data packages for studies conducted by the Alzheimer's Therapeutic Research Institute and the Alzheimer's Clinical Trial Consortium, with the hope of eventually expanding to other groups through a larger collaborative community. At some point, however, the meta-package might become impractically large. One way to mitigate this limitation would be to allow users to select which studies to include in their personalized version of the `alzverse`.

## Data Availability

Data is available from:

*	`A4LEARN`: [A4StudyData.org](A4StudyData.org)
*	`ADNIMERGE2`: [loni.usc.edu](loni.usc.edu)

Documentation is available from 

*	`A4LEARN`: [atri-biostats.github.io/A4LEARN/](https://atri-biostats.github.io/A4LEARN)
*	`ADNIMERGE2`: [atri-biostats.github.io/ADNIMERGE2](https://atri-biostats.github.io/ADNIMERGE2)

## Code Availability

R code is available for download from the following repositories:

* alzverse: [github.com/atri-biostats/alzverse](https://github.com/atri-biostats/alzverse)
*	A4LEARN: [github.com/atri-biostats/A4LEARN](https://github.com/atri-biostats/A4LEARN)
*	ADNIMERGE2: [github.com/atri-biostats/ADNIMERGE2](https://github.com/atri-biostats/ADNIMERGE2)

### R Code for the ADNIMERGE2 Example

```{r ref.label='adni-overall-summary', echo = TRUE, eval = FALSE}
```

```{r ref.label='adni-adas-indiv-profile-plot', echo = TRUE, eval = FALSE}
```

### R Code for the A4LEARN Example

```{r ref.label='a4learn-overall-summary', echo = TRUE, eval = FALSE}
```

### R Code for the alzverse Example

```{r ref.label='adni-a4-learn-indiv-profile-plot', echo = TRUE, eval = FALSE}
```

## Author Contributions

MCD contributed to conceptualization, software, validation, resources, data curation, writing the original draft, writing review & editing, and supervision. KH, OL, and RG contributed to software, validation, data curation, writing review & editing.  GJ-M contributed to conceptualization, software, validation, resources, data curation, writing review & editing, and supervision. PSA contributed to resources, writing review & editing, and supervision.

## Competing Interests

MCD has research grants from NIH and the Alzheimer’s Association, is a consultant to F. Hoffmann-La Roche Ltd, and his spouse is a full-time employee of Johnson & Johnson.

PSA has research grants from NIH, the Alzheimer’s Association, Janssen, Lilly, and Eisai, and consults with Merck, Roche, Genen-tech, Abbvie, Biogen, and ImmunoBrain Checkpoint.

Other authors report no relevant competing interests.

## Acknowledgements

The authors are grateful to the ADNI, A4, and LEARN participants, their families; and the study teams, including site investigators and staff. 

Data collection and sharing for the Alzheimer's Disease Neuroimaging Initiative (ADNI) is funded by the National Institute on Aging (NIA) (National Institutes of Health [NIH] Grant U19AG024904). The grantee organization is the Northern California Institute for Research and Education. In the past, ADNI has also received funding from the National Institute of Biomedical Imaging and Bioengineering, the Canadian Institutes of Health Research, and private sector contributions through the Foundation for the National Institutes of Health (FNIH) including generous contributions from the following: AbbVie, Alzheimer’s Association; Alzheimer’s Drug Discovery Foundation; Araclon Biotech; BioClinica, Inc.; Biogen; BristolMyers Squibb Company; CereSpir, Inc.; Cogstate; Eisai Inc.; Elan Pharmaceuticals, Inc.; Eli Lilly and Company; EuroImmun; F. Hoffmann-La Roche Ltd and its affiliated company Genentech, Inc.; Fujirebio; GE Healthcare; IXICO Ltd.; Janssen Alzheimer Immunotherapy Research & Development, LLC.; Johnson & Johnson Pharmaceutical Research & Development LLC.; Lumosity; Lundbeck; Merck & Co., Inc.; Meso Scale Diagnostics, LLC.; NeuroRx Research; Neurotrack Technologies; Novartis Pharmaceuticals Corporation; Pfizer Inc.; Piramal Imaging; Servier; Takeda Pharmaceutical Company; and Transition Therapeutics.

The A4 and LEARN Studies were supported by a public-private-philanthropic partnership which included funding from the NIA of the NIH (R01 AG063689, U19AG010483 and U24AG057437), Eli Lilly (also the supplier of active medication and placebo), the Alzheimer's Association, the Accelerating Medicines Partnership through the Foundation for the National Institutes of Health, the GHR Foundation, the Davis Alzheimer Prevention Program, the Yugilbar Foundation, Gates Ventures, an anonymous foundation, and additional private donors to Brigham and Women's Hospital, with in-kind support from Avid Radiopharmaceuticals, Cogstate, Albert Einstein College of Medicine and the Foundation for Neurologic Diseases. Open access funding provided by SCELC, Statewide California Electronic Library Consortium.
